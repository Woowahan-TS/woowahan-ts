# [9ì¥] í›…

## 9.1 ë¦¬ì•¡íŠ¸ í›…

### useState

- useStateë¥¼ ì‚¬ìš©í•  ë•Œ íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì ìš©í•˜ë©´ ì‚¬ì´ë“œ ì´í™íŠ¸ë¥¼ ì¤„ì¼ ìˆ˜ ìˆë‹¤.

```tsx
import { useState } from "react";

interface Member {
  name: string;
  age: number;
}

const MemberList = () => {
  const [memberList, setMemberList] = useState<Member []>([]);

  const sumAge = memberList.reduce((sum, member) => sum + member.age, 0);

  const addMember = () => {
    // Error: Type 'Member | { name: string; agee: number; }'
    // is not assignable to type 'Member'
    setMemberList([
      ...memberList,
      {
        name: "DokgoBaedal",
        agee: 11,
      },
    ]);
  };

  return (
    // ...
  );
};
```

### ì˜ì¡´ì„± ë°°ì—´ì„ ì‚¬ìš©í•˜ëŠ” í›…

- useEffectì™€ useLayoutEffect

  - useEffectì˜ ì •ì˜ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

  ```tsx
  function useEffect(effect: EffectCallback, deps?: DependencyList): void;
  type DependencyList = ReadonlyArray<any>;
  type EffectCallback = () => void | Destructor;
  ```

  - useEffectì˜ ì²« ë²ˆì§¸ ì¸ìì´ì effectì˜ íƒ€ì…ì¸ EffectCallbackì€ Destructorë¥¼ ë°˜í™˜í•˜ê±°ë‚˜ ì•„ë¬´ê²ƒë„ ë°˜í™˜í•˜ì§€ ì•ŠëŠ” í•¨ìˆ˜ì´ë‹¤.
  - Promise íƒ€ì…ì€ ë°˜í™˜í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ useEffectì˜ ì½œë°± í•¨ìˆ˜ì—ëŠ” ë¹„ë™ê¸° í•¨ìˆ˜ê°€ ë“¤ì–´ê°ˆ ìˆ˜ ì—†ë‹¤.
  - useEffectì—ì„œ ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤ë©´ ê²½ìŸ ìƒíƒœë¥¼ ë¶ˆëŸ¬ì¼ìœ¼í‚¬ ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.

  ```md
  ğŸ§ ì§šê³  ë„˜ì–´ê°€ê¸°

  ê²½ìŸ ìƒíƒœ(Race Condition)

  - ë©€í‹°ìŠ¤ë ˆë”© í™˜ê²½ì—ì„œ ë™ì‹œì— ì—¬ëŸ¬ í”„ë¡œì„¸ìŠ¤ë‚˜ ìŠ¤ë ˆë“œê°€ ê³µìœ ëœ ìì›ì— ì ‘ê·¼í•˜ë ¤ê³  í•  ë•Œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë¬¸ì œë‹¤.
  - ì´ëŸ¬í•œ ìƒí™©ì—ì„œ ì‹¤í–‰ ìˆœì„œë‚˜ íƒ€ì´ë°ì„ ì˜ˆì¸¡í•  ìˆ˜ ì—†ê²Œ ë˜ì–´ í”„ë¡œê·¸ë¨ ë™ì‘ì´ ì›í•˜ì§€ ì•ŠëŠ” ë°©í–¥ìœ¼ë¡œ íë¥¼ ìˆ˜ ìˆë‹¤.
  ```

  - ë‘ ë²ˆì¬ ì¸ìì¸ depsëŠ” ì˜µì…”ë„í•˜ê²Œ ì œê³µë˜ë©° effectê°€ ìˆ˜í–‰ë˜ê¸° ìœ„í•œ ì¡°ê±´ì„ ë‚˜ì—´í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ deps ë°°ì—´ì˜ ì›ì†Œê°€ ë³€ê²½ë˜ë©´ ì‹¤í–‰í•œë‹¤ëŠ” ì‹ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.
  - ë‹¤ë§Œ, depsì˜ ì›ì†Œë¡œ ìˆ«ìë‚˜ ë¬¸ìì—´ ê°™ì€ ê¸°ë³¸ ìë£Œí˜• ë§ê³  ê°ì²´ë‚˜ ë°°ì—´ì„ ë„£ì„ ë•ŒëŠ” ì£¼ì˜í•´ì•¼ í•œë‹¤.
  ```tsx
  type SomeObject  = {
    name: string;
    id: string;
  };

  interface LabelProps {
    value: SomeObject;
  }

  const Label: React.FC<LabelProps> = ({ value }) => {
    useEffect(() => {
      // value.nameê³¼ value.idë¥¼ ì‚¬ìš©í•´ì„œ ì‘ì—‰ã…‚í•œë‹¤
    ], [value]);

    // ...
  };
  ```
  - useEffectëŠ” depsê°€ ë³€ê²½ë˜ì—ˆëŠ”ì§€ë¥¼ ì–•ì€ ë¹„êµë¡œë§Œ íŒë‹¨í•œë‹¤.
  - ìœ„ì˜ ì½”ë“œì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë¬¸ì œëŠ”, depsë¡œ ë“¤ì–´ì˜¨ ê°ì²´ ê°’ì´ ë°”ë€Œì§€ ì•Šì•„ë„ ê°ì²´ì˜ ì°¸ì¡° ê°’ì´ ë³€ê²½ë˜ë©´ ì½œë°± í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì— ì˜ë„ì¹˜ ì•Šê²Œ ë¦¬ë Œë”ë§ì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤.
  - ë”°ë¼ì„œ, ë°‘ì— ì½”ë“œì²˜ëŸ¼ ë°”ê¿”ì¤„ í•„ìš”ê°€ ìˆë‹¤.
  ```tsx
  const { id, name } = value;
  useEffect(() => {
    // value.nameê³¼ value.id ëŒ€ì‹  name, idë¥¼ ì§ì ‘ ì‚¬ìš©í•œë‹¤.
  }, [id, name]);
  ```
  - useLayoutEffectë„ useEffectë‘ ë¹„ìŠ·í•˜ì§€ë§Œ ì—­í• ì˜ ì°¨ì´ê°€ ìˆë‹¤.
  - useEffectëŠ” ë ˆì´ì•„ì›ƒ ë°°ì¹˜ì™€ í™”ë©´ ë Œë”ë§ì´ ëª¨ë‘ ì™„ë£Œëœ í›„ì— ì‹¤í–‰ëœë‹¤.
  ```tsx
  const [name, setName] = useState("");

  useEffect(() => {
    // ë§¤ìš° ê¸´ ì‹œê°„ì´ íë¥¸ ë’¤ ì•„ë˜ì˜ setName()ì„ ì‹¤í–‰í•œë‹¤ê³  ìƒê°í•˜ì
    setName("ë°°ë‹¬ì´");
  }, []);

  return (
    <div>
      {`ì•ˆë…•í•˜ì„¸ìš”, ${name}ë‹˜!`}
    </div>
  );
  ```
  - ìœ„ì™€ ê°™ì´ useEffect ì½”ë“œë¡œ ë“¤ì–´ê°€ëŠ”ê²Œ ëŠ¦ê²Œ ì§„í–‰ë  ê²½ìš° ì‚¬ìš©ìëŠ” nameì´ ë¹„ì–´ìˆëŠ” í™”ë©´ì„ ê³„ì† ë³´ê²Œ ëœë‹¤.
  - ì´ë•Œ useLayoutEffectë¥¼ ì‚¬ìš©í•˜ë©´ í™”ë©´ì— ì»´í¬ë„ŒíŠ¸ê°€ ê·¸ë ¤ì§€ê¸° ì „ì— ì½œë°± í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ê¸° ë•Œë¬¸ì— ì²« ë²ˆì§¸ ë Œë”ë§ ë•Œ ë¹ˆ ì´ë¦„ì´ ëœ¨ëŠ” ê²½ìš°ë¥¼ ë°©ì§€í•  ìˆ˜ ìˆë‹¤.
 
- useMemoì™€ useCallback
  - useMemoì™€ useCallback ëª¨ë‘ ì´ì „ì— ìƒì„±ëœ ê°’ ë˜ëŠ” í•¨ìˆ˜ë¥¼ ê¸°ì–µí•˜ë©°, ë™ì¼í•œ ê°’ê³¼ í•¨ìˆ˜ë¥¼ ë°˜ë³µí•´ì„œ ìƒì„±í•˜ì§€ ì•Šë„ë¡ í•´ì£¼ëŠ” í›…ì´ë‹¤.
  - ì–´ë–¤ ê°’ì„ ê³„ì‚°í•˜ëŠ” ë° ì˜¤ëœ ì‹œê°„ì´ ê±¸ë¦´ ë•Œë‚˜ ë Œë”ë§ì´ ìì£¼ ë°œìƒí•˜ëŠ” formì—ì„œ useMemoë‚˜ useCallbackì„ ìœ ìš©í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
  - useMemoì™€ useCallbackë„ ì–•ì€ ë¹„êµë¡œ ë¹„êµí•˜ê¸° ë•Œë¬¸ì— ì£¼ì˜í•´ì•¼ í•œë‹¤.
 
- useRef
  - ë¦¬ì•¡íŠ¸ì—ì„œ input íƒœê·¸ ìš”ì†Œì— í¬ì»¤ìŠ¤ë¥¼ ì„¤ì •í•˜ê±°ë‚˜ íŠ¹ì • ì»´í¬ë„ŒíŠ¸ì˜ ìœ„ì¹˜ë¡œ ìŠ¤í¬ë¡¤ í•˜ëŠ” ë“± DOMì„ ì§ì ‘ ì„ íƒí•´ì•¼ í•˜ëŠ” ê²½ìš° useRefë¥¼ ì‚¬ìš©í•œë‹¤.
  ```tsx
  import { useRef } from "react";

  const MyComponent = () => {
    const ref = useRef<HTMLInputElement>(null);

    const onClick = () => {
      ref.current?.focus();
    };

    return (
      <>
        <button onClick={onClick}>refì— í¬ì»¤ìŠ¤!</button>
        <input ref={ref} />
      </>
    );
  };
  ```
  - ë§Œì•½ ì¼ë°˜ ì»¤ìŠ¤í…€ ì»´í¬ë„ŒíŠ¸ì—ì„œ refë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ forwardRefë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
  ```tsx
  interface Props {
    name: string;
  }

  const MyInput = forwardRef<HTMLInputElement, Props>((props, ref) => {
    return (
      <div>
        <label>{props.name}</label>
        <input ref={ref} />
      </div>
    );
  });
  ```

<br/>

## 9.2 ì»¤ìŠ¤í…€ í›…
### ë‚˜ë§Œì˜ í›… ë§Œë“¤ê¸°
- ë¦¬ì•¡íŠ¸ì—ì„œ ì œê³µí•˜ëŠ” useState, useEffect, useRef í›…ì— ë”í•´ ì‚¬ìš©ì ì •ì˜ í›…ì„ ìƒì„±í•˜ì—¬ ì»´í¬ë„ŒíŠ¸ ë¡œì§ì„ í•¨ìˆ˜ë¡œ ë½‘ì•„ë‚´ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
