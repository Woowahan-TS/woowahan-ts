# 2장 타입

## 2.1 타입이란

### 1. 자료형으로서의 타입

프로그래밍 언어에서 변수란 값을 저장할 수 있는 공간이자 값을 가리킨다.

자바스크립트는 아래의 7가지 데이터 타입(자료형)을 정의한다.

- undefined
- null
- Boolean
- String
- Symbol
- Numeric(Number 와 BigInt)
- Object

이와 같은 유형을 데이터 타입 또는 자료형이라고 하며, 데이터 타입은 여러 종류의 데이터를 식별하는 분류 체계로 컴파일러에 값의 형태를 알려준다.

> 이러한 타입을 사용해서 값의 종류를 명시할 수 있고 메모리를 더욱 효율적으로 사용할 수 있다.

### 2. 집합으로서의 타입

타입은 값이 가질 수 있는 유효한 범위의 집합을 말한다.

타입 시스템은 코드에서 사용되는 유효한 값의 범위를 제한해서 런타임에서 발생할 수 있는 유효하지 않은 값에 대한 에러를 방지해준다.

### 3. 정적 타입과 동적 타입

타입을 결정하는 시점에 따라 정적 타입과 동적 타입을 분류할 수 있다.

정적 타입 시스템에서는 모든 변수의 타입이 컴파일 시점에 결정된다.

동적 타입 시스템에서는 변수 타입이 런타임에서 결정된다. 자바스크립트는 동적 타입 언어이다.

```
컴파일과 런타임

컴파일 : 기계가(컴퓨터, 엔진)가 소스코드를 이해할 수 있도록 기계어로 변환되는 시점이다.
런타입 : 컴파일 이후 변환된 파일이 메모리에 적재되어 실행되는 시점이다.

```

### 4. 강타입과 약타입

암묵적 타입 변환 여부에 따라 타입 시스템을 강타입과 약타입으로 분류할 수 있다.

- 암묵적 타입 변환이란 컴파일러 또는 엔진 등에 의해서 런타임에 타입이 자동으로 변경되는 것을 말한다.

강타입 특징을 가진 언어는 서로 다른 타입을 갖는 값끼리 연산을 하면 에러가 발생하지만, 약타입 특징을 가진 언어는 컴파일러 또는 인터프리터가 내부적으로 판단해서 타입을 변환하여 연산을 수행한 후 값을 도출한다.

암묵적 변환은 개발자가 명시적으로 타입을 변환하지 않아도 다른 데이터 타입끼리 연산을 진행할 수 있는 편리함을 제공하지만, 작성자의 의도와 다르게 동작할 수 있기 때문에 예기치 못한 오류가 발생할 가능성이 높다.

### 5. 컴파일 방식

컴파일의 일반적인 의미는 사람이 이해할 수 있는 방식으로 작성한 코드를 컴퓨터가 이해할 수 있는 기계어로 바꿔주는 과정을 말한다.

하지만 타입스크립트에서의 컴파일을 자바스크립트의 컴파일 타임에 런타임 에러를 사전에 잡아내고 타입이 모두 제거된 자바스크립트 소스코드로 바꿔주는 과정이다.

> 이러한 특징을 가진 타입스크립트는 자바스크립트에 타입이라는 레이어를 끼얹은 일종의 템플릿 언어, 또는 확장 언어로 해석되기도 한다.

## 2.2 타입스크립트의 타입 시스템

### 1. 타입 애너테이션 방식

타입 애너테이션이란 변수나 상수 혹은 함수의 인자와 반환 값에 타입을 명시적으로 선언해서 어떤 타입 값이 저장될 것인지를 컴파일러에 직접 알려주는 문법이다.

### 2. 구조적 타이핑

타입스크립트는 이름으로 타입을 구분하는 명목적인 타입 언어의 특징과 달리 구조로 타입을 구분한다. 이를 구조적 타이핑이라고 한다.

### 3. 구조적 서브타이핑

구조적 서브타이핑이란 객체가 가지고 있는 속성(프로퍼티)을 바탕으로 타입을 구분하는 것이다. 이름이 다른 객체라도 가진 속성이 동일하다면 타입스크립트는 서로 호환이 가능한 동일한 타입으로 본다.

### 4. 자바스크립트를 닮은 타입스크립트

명목적 타이핑은 타입의 동일성을 확인하는 과정에서 구조적 타이핑에 비해 조금 더 안전하다. 객체의 속성을 다른 객체의 속성과 호환되지 않도록 하여 안정성을 추구하기 때문이다.

그런데도 타입스크립트가 구조적 타이핑을 채택한 이유는 타입스크립트가 자바스크립트를 모델링한 언어이기 때문이다.

자바스크립트는 덕 타이핑을 기반으로 하는데, 타입스크립트가 이런 동작을 그대로 모델링한다.

`덕 타이핑 : 어떤 타입에 부합하는 변수와 메서드를 가질 경우 해당 타입에 속하는 것으로 간주하는 방식이다.`

타입스크립트는 이러한 특징을 받아들여 명시적인 이름을 가지고 타입을 구분하는 대신 객체나 함수가 가진 구조적 특징을 기반으로 타이핑하는 방식을 택했다.

덕분에 타입스크립트는 더욱 유연한 타이핑이 가능해졌다.

덕 타이핑과 구조적 타이핑의 차이

- 덕 타이핑
  - 런타임에 타입을 검사한다.
  - 동적 타이핑에서 사용한다.
- 구조적 타이핑
  - 컴파일타임에 타입체커가 타입을 검사한다.
  - 정적 타이핑에서 사용한다.

### 5. 구조적 타이핑의 결과

구조적 타이핑의 특징 때문에 예기치 못한 결과가 나올 수도 있다.

선언된 객체 타입에 추가 속성을 가진 객체도 할당할 수 있기 때문에 타입 에러가 발생할 수 있는 것이다.

이러한 한계를 극복하기 위해 타입스크립트에 명목적 타이핑 언어의 특징을 가미한 식별할 수 있는 유니온 같은 방법이 생겨났다.

### 6. 타입스크립트의 점진석 타입 확인

타입스크립트는 컴파일 타임에 타입을 검사하면서 필요에 따라 타입 선언 생략을 허용하는 점진적 타입 확인 방법을 사용한다.

타입을 지정한 변수와 표현식은 정적으로 타입을 검사하지만 타입 선언이 생략된 경우에는 동적으로 검사를 수행한다. 타입 선언을 생략하면 암시적으로 타입 변환이 일어난다.

이러한 특징 때문에 타입스크립트의 타입 시스템은 정적 타입의 정확성을 100% 보장해주지 않는다. 모든 변수와 표현식의 타입을 컴파일타임에 검사하지 않아도 되기 때문에 타입이 올바르게 정해지지 않으면 런타임에서 에러가 발생하기도 한다.

```js

function add(x,y) {
    return x+y;
}

// 위 코드는 타입을 선언하지 않았기 때문에 암시적 타입 변환이 일어난다.
function add(x: any, y: any): any;

```

`any 타입은 타입스크립트 내 모든 타입의 종류를 포함하는 가장 상위 타입으로 어떤 타입 값이든 할당할 수 있다.`

### 7. 자바스크립트 슈퍼셋으로서의 타입스크립트

타입스크립트는 기존 자바스크립트 코드에 정적인 타이핑을 추가한 것으로 자바스크립트의 상위 집합이다.

그렇기 때문에 모든 자바스크립트 코드는 타입스크립트라고 볼 수 있지만, 반대로 모든 타입스크립트 코드가 자바스크립트 코드인 것은 아니다. 타입스크립트는 타입을 명시하는 문법을 가지고 있기 때문이다.

### 8. 값 vs 타입

값

- 값은 프로그램이 처리하기 위해 메모리에 저장하는 모든 데이터다.
- 프로그래밍 관점에서 문자열, 숫자, 변수, 매개변수, 객체, 함수 등이 값에 해당한다.
- 값은 어떠한 식을 연산한 것으로 변수에 할당할 수 있다.
- 값은 할당 연산자인 = 로 작성한다.

타입

- 타입은 변수, 매개변수, 객체 속성 등에 `: type` 형태로 타입을 명시한다.
- type 이나 interface 키워드로 커스텀 타입을 정의할 수도 있다.
- 타입과 변수를 같은 이름으로 정의할 수 있다.
  - 타입스크립트 문법인 type 으로 선언한 내용은 자바스크립트 런타임에서 제거되기 때문에 값 공간과 타입 공간의 이름은 서로 충돌하지 않는다.
- 타입은 주로 타입 선언(:) 또는 단언 문(as)으로 작성한다.

값과 타입 공간에 동시에 존재하는 심볼

- 클래스
  - 자바스크립트 ES6 에서 등장한 클래스는 객체 인스턴스를 더욱 쉽게 생성하기 위한 문법 기능으로 실제 동작은 함수와 같다.
  - 타입스크립트에서 클래스는 타입 애너테이션으로 사용할 수 있지만 런타임에서 객체로 변환되어 자바스크립트의 값으로 사용된다.
- enum
  - 클래스처럼 타입 공간에서 타입을 제한하는 역할을 하지만 런타입에 객체로 변환되어 값처럼 사용할 수 있다.
- 타입스크립트에서 어떠한 심볼이 값으로 사용된다는 것은 컴파일러를 사용해서 타입스크립트 파일을 자바스크립트 파일로 변환해도 여전히 자바스크립트 파일에 해당 정보가 남아있음을 의미한다. 그렇기 때문에 enum 의 경우 트리쉐이킹이 되지 않아 번들 사이즈에 영향을 줄 수 있다는 단점이 있다.

`트리쉐이킹이란 자바스크립트, 타입스크립트에서 사용하지 않는 코드를 삭제하는 방식이다. 나무를 흔들면 죽은 나뭇잎이 떨어지는 모습을 보고 이름을 따왔다고 한다. ES6 이후의 최신 애플리케이션 개발 환경에서는 웹팩, 롤업 같은 모듈 번들러를 사용하는데 이러한 도구로 번들링 작업을 수행할 때 사용하지 않는 코드는 자동으로 삭제된다.`

### 9. 타입을 확인하는 방법

typeof, instanceof, 타입 단언을 사용해서 타입을 확인 할 수 있다.

- typeof
  - 연산하기 전에 피연산자의 데이터 타입을 나타내는 문자열을 반환한다.
  - 값에서 사용된 typeof 는 자바스크립트 런타임의 typeof 연산자가 된다.
  - ```js
    const v1 = typeof person; // 값은 'object'
    const v2 = typeof email; // 값은 'function'
    ```
  - 타입에서 사용된 typeof 는 값을 읽고 타입스크립트 타입을 반환한다.
  - ```js
    type T1 = typeof person; // 타입은 Person
    type T2 = typeof email; // 타입은 (options: { person: Person; subject: string; body: string; }) => void
    ```
- 타입 단언인 as 를 사용해서 타입을 강제할 수도 있다.
  - 타입 단언은 개발자가 해당 값의 타입을 더 잘 파악할 수 있을 때 사용되며 강제 형 변환과 유사한 기능을 제공한다.
  - 타입 단언은 컴파일 단계에서는 형 변환을 강제할 수 있지만 런타임에서는 효력을 발휘하지는 못한다.

## 2.3 원시 타입

자바스크립트에서 값은 타입을 가지지만 변수는 별도의 타입을 가지지 않는다.<br/>
따라서 변수에는 어떤 타입의 값이라도 자유롭게 할당 할 수 있다.<br/>
타입스크립트는 이 변수에 타입을 지정할 수 있는 타입 시스템 체계를 구축한다.

### 1. boolean

- true, false 값만 할당 할 수 있다.
- 자바스크립트에는 boolean 원시 값은 아니지만 형 변환을 통해 true / false 로 취급되는 Truthy / Falsy 값이 존재한다. 하지만 이 값은 boolean 원시 값이 아니므로 boolean 타입에 해당하지 않는다.

### 2. undefined

- 정의되지 않았다는 의미의 타입으로 오직 undefined 값만 할당 할 수 있다.
- 초기화되지 않거나 존재하지 않는 값을 의미한다.

### 3. null

- 오직 null 만 할당 할 수 있다.
- 명시적/의도적으로 값이 아직 비어있을 수 있음을 보여줄 때 사용한다.

### 4. number

- 숫자에 해당하는 모든 원시 값을 할당할 수 있다.

### 5. bigInt

- 자바스크립트에서 가장 큰 수를 넘어가는 값에 사용된다.

### 6. string

- 문자열을 할당할 수 있는 타입이다.

### 7. symbol

- 어떤 값과도 중복되지 않는 유일한 값을 생성할 수 있다.
- symbol 타입과 const 선언에서만 사용할 수 있는 unique symbol 타입이라는 symbol 하위 타입이 있다.

## 2.4 객체 타입

앞의 7가지 원시 타입에 속하지 않는 값은 모두 객체 타입으로 분류할 수 있다.

### 1. object

- 자바스크립트 객체의 정의에 맞게 대응하는 타입 시스템이다.
- object 타입은 any 타입과 유사하게 객체에 해당하는 원시 타입을 제외한 모든 타입 값을 유동적으로 할당할 수 있어 정적 타이핑의 의미가 크게 퇴색될 수 있어 사용하지 않는 것을 권장한다.
- 실무에서는 잘 사용되지 않는다. 객체를 타이핑하기 위해 자주 사용되는 키워드는 type 과 interface 가 있다.

### 2. {}

- 객체를 타이핑할 때 중괄호 안에 객체의 속성 타입을 지정해주는 식으로 사용한다.
- 빈 객체를 표현할 때 {} 를 사용하기도 하는데 이 경우 어떤 값도 속성으로 할당할 수 없다.

### 3. array

- 타입스크립트에서는 배열을 array 라는 별도 타입으로 다룬다.
- Array 키워드로 선언하거나 대괄호([])를 사용해서 선언한다.
- 주의할 점은 튜플 타입도 대괄호([])로 선언한다는 점이다.
  - 배열과 유사하지만 차이점이 존재한다. 배열과는 다르게 선언 시점에 지정해준 타입 값만 할당할 수 있고, 개수도 선언 시점에 정해놓은 개수에 맞게 할당해야 한다.

### 4. type 과 interface 키워드

- 객체를 타이핑하기 위해 자주 사용되는 type 과 interface 는 중괄호를 사용한 객체 리터럴 방식이다.
- 반복적으로 사용되는 타입의 경우 중복을 피하기 위해 type 이나 interface 로 타입을 선언해 사용할 수 있다.

### 5. function

- 자바스크립트에서는 함수도 일종의 객체로 간주하지만 typeof 연산자로 함수 타입을 출력하면 function 으로 나타난다.
